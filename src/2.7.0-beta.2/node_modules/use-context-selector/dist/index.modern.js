import{createContext as e,useRef as r,createElement as t,useContext as n,useReducer as o,useEffect as c,useLayoutEffect as u}from"react";import{unstable_runWithPriority as s,unstable_NormalPriority as i}from"scheduler";import{unstable_batchedUpdates as d}from"react-dom";const p=Symbol(),a=Symbol(),f="undefined"==typeof window||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?c:u,l=s?e=>s(i,e):e=>e(),v=e=>e;function w(n){const o=e({[p]:{v:{current:n},n:{current:-1},l:new Set,u:e=>e()}});var c;return o[a]=o.Provider,o.Provider=(c=o.Provider,({value:e,children:n})=>{const o=r(e),u=r(0),s=r();if(!s.current){const e=new Set,r=r=>{d(()=>{u.current+=1,e.forEach(e=>e([u.current])),r()})};s.current={[p]:{v:o,n:u,l:e,u:r}}}return f(()=>{o.current=e,u.current+=1,l(()=>{s.current[p].l.forEach(r=>{r([u.current,e])})})},[e]),t(c,{value:s.current},n)}),delete o.Consumer,o}function E(e,r){const t=n(e)[p];if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!t)throw new Error("useContextSelector requires special context");const{v:{current:c},n:{current:u},l:s}=t,i=r(c),[d,a]=o((e,t)=>{if(!t)return[c,i];if(t[0]<=u)return Object.is(e[1],i)?e:[c,i];try{if(2===t.length){if(Object.is(e[0],t[1]))return e;const n=r(t[1]);return Object.is(e[1],n)?e:[t[1],n]}}catch(e){}return[...e]},[c,i]);return Object.is(d[1],i)||a(),f(()=>(s.add(a),()=>{s.delete(a)}),[s]),d[1]}function h(e){return E(e,v)}function b(e){const r=n(e)[p];if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!r)throw new Error("useContextUpdate requires special context");const{u:t}=r;return t}const m=({context:e,value:r,children:n})=>{const{[a]:o}=e;if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!o)throw new Error("BridgeProvider requires special context");return t(o,{value:r},n)},x=e=>{const r=n(e);if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!r[p])throw new Error("useBridgeValue requires special context");return r};export{m as BridgeProvider,w as createContext,x as useBridgeValue,h as useContext,E as useContextSelector,b as useContextUpdate};
//# sourceMappingURL=index.modern.js.map
